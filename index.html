<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Garderob.">
  <meta name="theme-color" content="#ffffff">
  <title>Garderob.</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-primary: #f8f9fa;
      --bg-card: #ffffff;
      --bg-secondary: #f3f4f6;
      --text-primary: #111111;
      --text-secondary: #6b7280;
      --text-tertiary: #9ca3af;
      --accent: #111111;
      --accent-soft: #f3f4f6;
      --border: #e5e7eb;
      --shadow-sm: 0 1px 2px rgba(0,0,0,0.04);
      --shadow-md: 0 4px 20px rgba(0,0,0,0.06);
      --shadow-lg: 0 12px 40px rgba(0,0,0,0.1);
      --radius-sm: 12px;
      --radius-md: 16px;
      --radius-lg: 24px;
      --radius-xl: 32px;
      --title-gradient: linear-gradient(135deg, #111 0%, #444 100%);
      --picker-bg: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
      --picker-text: #ffffff;
    }

    /* Themes */
    [data-theme="standard"] {
      --bg-primary: #f8f9fa;
      --bg-card: #ffffff;
      --bg-secondary: #f3f4f6;
      --text-primary: #111111;
      --text-secondary: #6b7280;
      --text-tertiary: #9ca3af;
      --accent: #111111;
      --accent-soft: #f3f4f6;
      --border: #e5e7eb;
      --title-gradient: linear-gradient(135deg, #111 0%, #444 100%);
      --picker-bg: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
      --picker-text: #ffffff;
    }

    [data-theme="rose"] {
      --bg-primary: #fff1f2;
      --bg-card: #ffffff;
      --bg-secondary: #ffe4e6;
      --text-primary: #881337;
      --text-secondary: #be185d;
      --text-tertiary: #f472b6;
      --accent: #be185d;
      --accent-soft: #ffe4e6;
      --border: #fecdd3;
      --title-gradient: linear-gradient(135deg, #881337 0%, #be185d 100%);
      --picker-bg: linear-gradient(135deg, #881337 0%, #be185d 100%);
      --picker-text: #ffffff;
    }

    [data-theme="sky"] {
      --bg-primary: #f0f9ff;
      --bg-card: #ffffff;
      --bg-secondary: #e0f2fe;
      --text-primary: #0c4a6e;
      --text-secondary: #0369a1;
      --text-tertiary: #7dd3fc;
      --accent: #0369a1;
      --accent-soft: #e0f2fe;
      --border: #bae6fd;
      --title-gradient: linear-gradient(135deg, #0c4a6e 0%, #0369a1 100%);
      --picker-bg: linear-gradient(135deg, #0c4a6e 0%, #0369a1 100%);
      --picker-text: #ffffff;
    }

    [data-theme="mint"] {
      --bg-primary: #f0fdf4;
      --bg-card: #ffffff;
      --bg-secondary: #dcfce7;
      --text-primary: #14532d;
      --text-secondary: #15803d;
      --text-tertiary: #86efac;
      --accent: #15803d;
      --accent-soft: #dcfce7;
      --border: #bbf7d0;
      --title-gradient: linear-gradient(135deg, #14532d 0%, #15803d 100%);
      --picker-bg: linear-gradient(135deg, #14532d 0%, #15803d 100%);
      --picker-text: #ffffff;
    }

    [data-theme="lavender"] {
      --bg-primary: #faf5ff;
      --bg-card: #ffffff;
      --bg-secondary: #f3e8ff;
      --text-primary: #581c87;
      --text-secondary: #7e22ce;
      --text-tertiary: #d8b4fe;
      --accent: #7e22ce;
      --accent-soft: #f3e8ff;
      --border: #e9d5ff;
      --title-gradient: linear-gradient(135deg, #581c87 0%, #7e22ce 100%);
      --picker-bg: linear-gradient(135deg, #581c87 0%, #7e22ce 100%);
      --picker-text: #ffffff;
    }

    [data-theme="peach"] {
      --bg-primary: #fff7ed;
      --bg-card: #ffffff;
      --bg-secondary: #ffedd5;
      --text-primary: #7c2d12;
      --text-secondary: #c2410c;
      --text-tertiary: #fdba74;
      --accent: #c2410c;
      --accent-soft: #ffedd5;
      --border: #fed7aa;
      --title-gradient: linear-gradient(135deg, #7c2d12 0%, #c2410c 100%);
      --picker-bg: linear-gradient(135deg, #7c2d12 0%, #c2410c 100%);
      --picker-text: #ffffff;
    }

    [data-theme="lemon"] {
      --bg-primary: #fefce8;
      --bg-card: #ffffff;
      --bg-secondary: #fef9c3;
      --text-primary: #713f12;
      --text-secondary: #a16207;
      --text-tertiary: #fde047;
      --accent: #a16207;
      --accent-soft: #fef9c3;
      --border: #fef08a;
      --title-gradient: linear-gradient(135deg, #713f12 0%, #a16207 100%);
      --picker-bg: linear-gradient(135deg, #713f12 0%, #a16207 100%);
      --picker-text: #ffffff;
    }

    [data-theme="dark"] {
      --bg-primary: #09090b;
      --bg-card: #18181b;
      --bg-secondary: #27272a;
      --text-primary: #fafafa;
      --text-secondary: #a1a1aa;
      --text-tertiary: #52525b;
      --accent: #fafafa;
      --accent-soft: #27272a;
      --border: #3f3f46;
      --title-gradient: linear-gradient(135deg, #ffffff 0%, #a1a1aa 100%);
      --picker-bg: linear-gradient(135deg, #27272a 0%, #3f3f46 100%);
      --picker-text: #ffffff;
    }

    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }
    
    body { 
      font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      -webkit-tap-highlight-color: transparent;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
      touch-action: manipulation;
      overscroll-behavior: none;
      padding-top: env(safe-area-inset-top);
      padding-bottom: env(safe-area-inset-bottom);
      overflow-x: hidden;
    }

    /* Prevent text selection on interactive elements */
    button, .card, .filter-pill, .theme-option {
      -webkit-user-select: none;
      user-select: none;
    }

    /* GPU acceleration for smooth animations */
    .card, .btn, .picker-btn, .fab, .detail, .form-sheet, .result-modal {
      -webkit-transform: translateZ(0);
      transform: translateZ(0);
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
    }

    /* Animations */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-10px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .animate-fade-in { animation: fadeIn 0.6s ease-out forwards; }
    .animate-fade-in-up { animation: fadeInUp 0.6s ease-out forwards; }
    .animate-float { animation: float 3s ease-in-out infinite; }

    /* Container */
    .container { 
      padding: 20px; 
      padding-bottom: 120px; 
      max-width: 540px; 
      margin: 0 auto;
    }

    /* Header */
    .header {
      padding: 16px 0 24px;
      animation: fadeInUp 0.6s ease-out;
    }

    .header-top {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 8px;
    }

    .greeting {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-tertiary);
      letter-spacing: 0.5px;
      text-transform: uppercase;
      margin-bottom: 4px;
    }

    .header h1 {
      font-size: 34px;
      font-weight: 700;
      letter-spacing: -0.8px;
      background: var(--title-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      -webkit-transform: translateZ(0);
      transform: translateZ(0);
    }

    .header-actions {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .lang-btn {
      background: var(--bg-card);
      border: 1px solid var(--border);
      color: var(--text-primary);
      padding: 10px 14px;
      border-radius: var(--radius-md);
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s ease, border-color 0.2s ease;
      font-family: inherit;
      box-shadow: var(--shadow-sm);
      -webkit-transform: translateZ(0);
    }

    .lang-btn:hover { 
      background: var(--accent-soft);
      transform: translateY(-1px);
    }

    /* Theme Selector */
    .theme-btn {
      background: var(--bg-card);
      border: 1px solid var(--border);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      transition: transform 0.2s ease, border-color 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      box-shadow: var(--shadow-sm);
      -webkit-transform: translateZ(0);
    }

    .theme-btn:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .settings-btn {
      background: var(--bg-card);
      border: 1px solid var(--border);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      transition: transform 0.2s ease, border-color 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      box-shadow: var(--shadow-sm);
      -webkit-transform: translateZ(0);
    }

    .settings-btn:hover {
      transform: translateY(-1px) rotate(45deg);
      box-shadow: var(--shadow-md);
    }

    /* Weather Bar */
    .weather-bar {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 16px;
      padding: 14px 18px;
      background: var(--accent-soft);
      border-radius: var(--radius-md);
      animation: fadeInUp 0.4s ease-out 0.1s backwards;
    }

    .weather-icon {
      font-size: 24px;
    }

    .weather-temp {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-primary);
    }

    .weather-tip {
      font-size: 14px;
      color: var(--text-secondary);
      margin-left: auto;
    }

    /* Settings Modal */
    .settings-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.4);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: 250;
      animation: fadeIn 0.3s ease-out;
    }

    .settings-modal {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-card);
      border-radius: var(--radius-xl) var(--radius-xl) 0 0;
      padding: 24px 20px 40px;
      z-index: 251;
      animation: slideUp 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      max-height: 85vh;
      overflow-y: auto;
    }

    .settings-handle {
      width: 40px;
      height: 4px;
      background: var(--border);
      border-radius: 100px;
      margin: 0 auto 20px;
    }

    .settings-modal h3 {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 24px;
      text-align: center;
      color: var(--text-primary);
    }

    .settings-section {
      margin-bottom: 24px;
    }

    .settings-label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .settings-input {
      width: 100%;
      padding: 14px 16px;
      border: 2px solid var(--border);
      border-radius: var(--radius-md);
      font-size: 16px;
      font-family: inherit;
      background: var(--bg-primary);
      color: var(--text-primary);
      outline: none;
      transition: border-color 0.2s ease;
      -webkit-appearance: none;
    }

    .settings-input:focus {
      border-color: var(--accent);
    }

    .settings-input::placeholder {
      color: var(--text-muted);
    }

    .settings-weather-preview {
      margin-top: 10px;
      padding: 12px 14px;
      background: var(--accent-soft);
      border-radius: var(--radius-sm);
      font-size: 14px;
      color: var(--text-secondary);
    }

    .settings-desc {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 12px;
    }

    .settings-danger {
      margin-top: 32px;
      padding-top: 24px;
      border-top: 1px solid var(--border);
    }

    .settings-reset-btn {
      width: 100%;
      padding: 14px;
      background: #fef2f2;
      color: #dc2626;
      border: none;
      border-radius: var(--radius-md);
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      font-family: inherit;
      transition: background 0.2s ease;
    }

    .settings-reset-btn:hover {
      background: #fee2e2;
    }

    .theme-modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.4);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: 250;
      animation: fadeIn 0.3s ease-out;
    }

    .theme-modal {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-card);
      border-radius: var(--radius-xl) var(--radius-xl) 0 0;
      padding: 24px 20px 40px;
      z-index: 251;
      animation: slideUp 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .theme-modal-handle {
      width: 40px;
      height: 4px;
      background: var(--border);
      border-radius: 100px;
      margin: 0 auto 20px;
    }

    .theme-modal h3 {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px;
      text-align: center;
    }

    .theme-modal-subtitle {
      font-size: 14px;
      color: var(--text-secondary);
      text-align: center;
      margin-bottom: 24px;
    }

    .theme-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
    }

    .theme-option {
      aspect-ratio: 1;
      border-radius: var(--radius-md);
      border: 3px solid transparent;
      cursor: pointer;
      transition: transform 0.2s ease, border-color 0.2s ease;
      position: relative;
      overflow: hidden;
      -webkit-transform: translateZ(0);
    }

    .theme-option:hover {
      transform: scale(1.05);
    }

    .theme-option.active {
      border-color: var(--accent);
    }

    .theme-option.active::after {
      content: '✓';
      position: absolute;
      bottom: 4px;
      right: 4px;
      width: 20px;
      height: 20px;
      background: var(--accent);
      color: white;
      border-radius: 50%;
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .theme-option-standard { background: linear-gradient(135deg, #f8f9fa 0%, #e5e7eb 100%); }
    .theme-option-rose { background: linear-gradient(135deg, #fff1f2 0%, #fecdd3 100%); }
    .theme-option-sky { background: linear-gradient(135deg, #f0f9ff 0%, #bae6fd 100%); }
    .theme-option-mint { background: linear-gradient(135deg, #f0fdf4 0%, #bbf7d0 100%); }
    .theme-option-lavender { background: linear-gradient(135deg, #faf5ff 0%, #e9d5ff 100%); }
    .theme-option-peach { background: linear-gradient(135deg, #fff7ed 0%, #fed7aa 100%); }
    .theme-option-lemon { background: linear-gradient(135deg, #fefce8 0%, #fef08a 100%); }
    .theme-option-dark { background: linear-gradient(135deg, #1a1a1a 0%, #3f3f46 100%); }

    .theme-label {
      font-size: 12px;
      color: var(--text-secondary);
      text-align: center;
      margin-top: 6px;
      font-weight: 500;
    }

    /* Stats Bar */
    .stats-bar {
      display: flex;
      gap: 12px;
      margin: 24px 0;
      animation: fadeInUp 0.6s ease-out 0.1s backwards;
    }

    .stat-item {
      flex: 1;
      background: var(--bg-card);
      border-radius: var(--radius-md);
      padding: 16px;
      text-align: center;
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--border);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      -webkit-transform: translateZ(0);
    }

    .stat-item:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .stat-number {
      font-size: 28px;
      font-weight: 700;
      color: var(--text-primary);
      line-height: 1;
    }

    .stat-label {
      font-size: 11px;
      font-weight: 600;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 6px;
    }

    /* Filter Pills */
    .filter-section {
      margin: 28px 0 24px;
      animation: fadeInUp 0.6s ease-out 0.2s backwards;
    }

    .filter-label {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-bottom: 12px;
    }

    .filter-pills {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      padding-bottom: 8px;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }

    .filter-pills::-webkit-scrollbar { display: none; }

    .filter-pill {
      flex-shrink: 0;
      padding: 10px 18px;
      border-radius: 100px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.25s ease, color 0.25s ease, border-color 0.25s ease, box-shadow 0.25s ease;
      border: 1px solid var(--border);
      background: var(--bg-card);
      color: var(--text-secondary);
      font-family: inherit;
      -webkit-transform: translateZ(0);
    }

    .filter-pill:hover {
      border-color: var(--accent);
      color: var(--text-primary);
    }

    .filter-pill.active {
      background: var(--accent);
      color: var(--bg-card);
      border-color: var(--accent);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    /* Grid */
    .grid-section {
      animation: fadeInUp 0.6s ease-out 0.3s backwards;
    }

    .grid-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .grid-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.8px;
    }

    .grid-count {
      font-size: 13px;
      color: var(--text-tertiary);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
    }

    /* Cards */
    .card {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94), 
                  box-shadow 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--border);
      opacity: 0;
      animation: fadeInUp 0.5s ease-out forwards;
      will-change: transform;
    }

    .card:nth-child(1) { animation-delay: 0.1s; }
    .card:nth-child(2) { animation-delay: 0.15s; }
    .card:nth-child(3) { animation-delay: 0.2s; }
    .card:nth-child(4) { animation-delay: 0.25s; }
    .card:nth-child(5) { animation-delay: 0.3s; }
    .card:nth-child(6) { animation-delay: 0.35s; }

    .card:active {
      transform: scale(0.97);
    }

    @media (hover: hover) {
      .card:hover {
        transform: translateY(-6px);
        box-shadow: var(--shadow-lg);
      }

      .card:hover .card-image {
        transform: scale(1.05);
      }
    }

    .card-image-wrapper {
      position: relative;
      overflow: hidden;
      aspect-ratio: 4/5;
    }

    .card-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }

    .card-placeholder {
      width: 100%;
      height: 100%;
      background: var(--accent-soft);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 48px;
    }

    .card-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 60px 16px 16px;
      background: linear-gradient(to top, rgba(0,0,0,0.7) 0%, transparent 100%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .card:hover .card-overlay {
      opacity: 1;
    }

    .card-overlay-text {
      color: white;
      font-size: 12px;
      font-weight: 500;
    }

    .card-content {
      padding: 14px 16px 16px;
    }

    .card-title {
      font-weight: 600;
      font-size: 15px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      color: var(--text-primary);
    }

    .card-meta {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-top: 6px;
    }

    .card-occasion {
      font-size: 12px;
      color: var(--text-tertiary);
      font-weight: 500;
    }

    .card-dot {
      width: 3px;
      height: 3px;
      border-radius: 50%;
      background: var(--text-tertiary);
    }

    .card-items {
      font-size: 12px;
      color: var(--text-tertiary);
    }

    /* Favorite Button on Card */
    .card-favorite {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: rgba(255,255,255,0.9);
      backdrop-filter: blur(10px);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      z-index: 10;
      transition: all 0.2s ease;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .card-favorite:active {
      transform: scale(0.9);
    }

    .card-favorite.active {
      background: #fee2e2;
      color: #ef4444;
    }

    /* Last Worn Badge */
    .card-last-worn {
      position: absolute;
      top: 10px;
      left: 10px;
      padding: 4px 10px;
      border-radius: 20px;
      background: rgba(255,255,255,0.9);
      backdrop-filter: blur(10px);
      font-size: 11px;
      font-weight: 600;
      color: var(--text-secondary);
      z-index: 10;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .card-last-worn.recent {
      background: rgba(34, 197, 94, 0.9);
      color: white;
    }

    /* Delete Confirmation Modal */
    .confirm-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 200;
      animation: fadeIn 0.2s ease;
      padding: 20px;
    }

    .confirm-modal {
      background: var(--bg-card);
      border-radius: var(--radius-xl);
      padding: 28px;
      width: 100%;
      max-width: 320px;
      text-align: center;
      animation: scaleIn 0.25s ease;
      box-shadow: var(--shadow-lg);
    }

    .confirm-icon {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: #fef2f2;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      margin: 0 auto 16px;
    }

    .confirm-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .confirm-text {
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 24px;
    }

    .confirm-buttons {
      display: flex;
      gap: 12px;
    }

    .confirm-btn {
      flex: 1;
      padding: 14px;
      border-radius: var(--radius-md);
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
    }

    .confirm-btn-cancel {
      background: var(--bg-secondary);
      color: var(--text-primary);
    }

    .confirm-btn-delete {
      background: #ef4444;
      color: white;
    }

    .confirm-btn:active {
      transform: scale(0.97);
    }

    /* Wear Today Button */
    .wear-today-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
      color: white;
      border: none;
      border-radius: var(--radius-md);
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-bottom: 12px;
    }

    .wear-today-btn:active {
      transform: scale(0.97);
    }

    .wear-today-btn.worn {
      background: linear-gradient(135deg, #a3e635 0%, #84cc16 100%);
    }

    /* Detail Favorite Button */
    .detail-favorite {
      position: absolute;
      top: calc(20px + env(safe-area-inset-top, 55px));
      right: 20px;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: rgba(255,255,255,0.95);
      backdrop-filter: blur(10px);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
      z-index: 60;
      transition: all 0.2s ease;
      box-shadow: 0 2px 12px rgba(0,0,0,0.15);
    }

    @supports (top: env(safe-area-inset-top)) {
      .detail-favorite {
        top: calc(20px + env(safe-area-inset-top, 55px));
      }
    }

    .detail-favorite:active {
      transform: scale(0.9);
    }

    .detail-favorite.active {
      background: #fee2e2;
      color: #ef4444;
    }

    /* Last Worn Info in Detail */
    .detail-last-worn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 16px;
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      margin-bottom: 16px;
      font-size: 14px;
      color: var(--text-secondary);
    }

    .detail-last-worn-icon {
      font-size: 16px;
    }

    /* Empty State */
    .empty {
      text-align: center;
      padding: 60px 20px;
      animation: fadeIn 0.8s ease-out;
    }

    .empty-illustration {
      width: 180px;
      height: 180px;
      margin: 0 auto 32px;
      position: relative;
    }

    .empty-circle {
      position: absolute;
      border-radius: 50%;
      background: var(--accent-soft);
    }

    .empty-circle-1 {
      width: 180px;
      height: 180px;
      top: 0;
      left: 0;
      animation: pulse 4s ease-in-out infinite;
    }

    .empty-circle-2 {
      width: 120px;
      height: 120px;
      top: 30px;
      left: 30px;
      background: var(--border);
      animation: pulse 4s ease-in-out infinite 0.5s;
    }

    .empty-icon {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 48px;
      animation: float 3s ease-in-out infinite;
    }

    .empty-title {
      font-size: 22px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .empty-text {
      font-size: 15px;
      color: var(--text-secondary);
      max-width: 260px;
      margin: 0 auto;
      line-height: 1.5;
    }

    .empty-cta {
      margin-top: 32px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 14px 28px;
      background: var(--accent);
      color: var(--bg-card);
      border: none;
      border-radius: 100px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: inherit;
      box-shadow: 0 4px 16px rgba(0,0,0,0.2);
    }

    .empty-cta:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 24px rgba(0,0,0,0.25);
    }

    .empty-cta:active {
      transform: scale(0.97);
    }

    /* FAB */
    .fab {
      position: fixed;
      bottom: 32px;
      right: 20px;
      width: 60px;
      height: 60px;
      background: var(--accent);
      color: var(--bg-card);
      border: none;
      border-radius: 50%;
      font-size: 28px;
      font-weight: 300;
      box-shadow: 0 6px 24px rgba(0,0,0,0.25);
      cursor: pointer;
      transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94), 
                  box-shadow 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      z-index: 100;
      animation: fadeInUp 0.6s ease-out 0.5s backwards;
      will-change: transform;
      -webkit-transform: translateZ(0);
    }

    .fab:hover {
      transform: scale(1.08);
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    }

    .fab:active {
      transform: scale(0.95);
    }

    /* Form */
    .form-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.4);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: 200;
      animation: fadeIn 0.3s ease-out;
    }

    .form {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-card);
      border-radius: var(--radius-xl) var(--radius-xl) 0 0;
      padding: 24px 20px 40px;
      z-index: 201;
      max-height: 90vh;
      overflow-y: auto;
      animation: slideUp 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    @keyframes slideUp {
      from { transform: translateY(100%); }
      to { transform: translateY(0); }
    }

    .form-handle {
      width: 40px;
      height: 4px;
      background: var(--border);
      border-radius: 100px;
      margin: 0 auto 20px;
    }

    .form h2 {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 24px;
      text-align: center;
    }

    .form-fields {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .input-group {
      position: relative;
    }

    .input-label {
      position: absolute;
      left: 18px;
      top: -8px;
      font-size: 11px;
      font-weight: 600;
      color: var(--text-tertiary);
      background: var(--bg-card);
      padding: 0 6px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    input, select {
      width: 100%;
      background: var(--bg-card);
      border: 1.5px solid var(--border);
      border-radius: var(--radius-md);
      padding: 16px 18px;
      color: var(--text-primary);
      font-size: 16px;
      font-family: inherit;
      outline: none;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
      /* iOS fixes */
      -webkit-appearance: none;
      border-radius: var(--radius-md);
    }

    input:focus, select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(0,0,0,0.05);
    }

    input::placeholder { 
      color: var(--text-tertiary);
      opacity: 1; /* Firefox fix */
    }
    select { 
      -webkit-appearance: none;
      appearance: none; 
      cursor: pointer;
    }

    .image-upload {
      background: var(--accent-soft);
      border: 2px dashed var(--border);
      border-radius: var(--radius-lg);
      padding: 40px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .image-upload:hover {
      border-color: var(--text-tertiary);
      background: #eef0f2;
    }

    .image-upload-icon { font-size: 40px; margin-bottom: 12px; }
    .image-upload-text { color: var(--text-secondary); font-size: 14px; font-weight: 500; }
    .image-preview { height: 140px; width: 140px; object-fit: cover; border-radius: var(--radius-md); margin: 0 auto; }
    .hidden { display: none; }

    .btn-row { display: flex; gap: 12px; margin-top: 28px; }

    .btn {
      flex: 1;
      padding: 16px;
      border-radius: var(--radius-md);
      font-size: 16px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: transform 0.2s ease, opacity 0.2s ease, background 0.2s ease;
      font-family: inherit;
      will-change: transform;
    }

    .btn:active { transform: scale(0.97); }
    .btn-secondary { background: var(--accent-soft); color: var(--text-primary); }
    .btn-secondary:hover { background: var(--border); }
    .btn-primary { background: var(--accent); color: var(--bg-card); }
    .btn-primary:hover { opacity: 0.9; }
    .btn-primary:disabled { opacity: 0.4; cursor: not-allowed; }

    /* Detail View */
    .detail {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--bg-primary);
      animation: fadeIn 0.4s ease-out;
      z-index: 50;
      display: flex;
      flex-direction: column;
    }

    .detail-back-wrapper {
      position: absolute;
      top: 75px;
      left: 16px;
      z-index: 100;
    }

    @supports (top: env(safe-area-inset-top)) {
      .detail-back-wrapper {
        top: calc(20px + env(safe-area-inset-top, 55px));
        left: calc(16px + env(safe-area-inset-left, 0px));
      }
    }

    .detail-back {
      width: 44px;
      height: 44px;
      background: rgba(255,255,255,0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: none;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 12px rgba(0,0,0,0.2);
    }

    .detail-back:active {
      background: white;
      transform: scale(0.95);
    }

    .detail-scroll {
      flex: 1;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }

    .detail-hero {
      position: relative;
      height: 50vh;
      min-height: 360px;
      overflow: hidden;
    }

    .detail-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .detail-no-image {
      width: 100%;
      height: 100%;
      background: var(--accent-soft);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 80px;
    }

    .detail-hero-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.6) 0%, transparent 50%);
    }

    .detail-hero-content {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 24px 20px;
      color: white;
    }

    .detail-title {
      font-size: 32px;
      font-weight: 700;
      letter-spacing: -0.5px;
      margin-bottom: 8px;
      text-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }

    .detail-tag {
      display: inline-block;
      font-size: 13px;
      background: rgba(255,255,255,0.2);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      padding: 8px 16px;
      border-radius: 100px;
      font-weight: 500;
    }

    .detail-content {
      padding: 24px 20px;
      margin-top: -20px;
      background: var(--bg-primary);
      border-radius: var(--radius-xl) var(--radius-xl) 0 0;
      position: relative;
    }

    .detail-section-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-bottom: 16px;
    }

    .detail-items {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .detail-item {
      display: flex;
      align-items: center;
      gap: 16px;
      background: var(--bg-card);
      padding: 18px 20px;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--border);
      animation: slideIn 0.4s ease-out backwards;
    }

    .detail-item:nth-child(1) { animation-delay: 0.1s; }
    .detail-item:nth-child(2) { animation-delay: 0.15s; }
    .detail-item:nth-child(3) { animation-delay: 0.2s; }
    .detail-item:nth-child(4) { animation-delay: 0.25s; }
    .detail-item:nth-child(5) { animation-delay: 0.3s; }

    .detail-item-icon {
      width: 48px;
      height: 48px;
      background: var(--accent-soft);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .detail-item-label {
      font-size: 11px;
      color: var(--text-tertiary);
      margin-bottom: 2px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 600;
    }

    .detail-item-value {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .detail-actions {
      margin-top: 32px;
      padding-top: 24px;
      border-top: 1px solid var(--border);
    }

    .delete-btn {
      width: 100%;
      padding: 16px;
      background: #fef2f2;
      color: #dc2626;
      border: none;
      border-radius: var(--radius-md);
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: inherit;
    }

    .delete-btn:hover {
      background: #fee2e2;
    }

    .edit-btn {
      width: 100%;
      padding: 16px;
      background: var(--accent);
      color: var(--bg-card);
      border: none;
      border-radius: var(--radius-md);
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: inherit;
      margin-bottom: 12px;
    }

    .edit-btn:hover {
      opacity: 0.9;
    }

    /* Pinterest Inspiration Button */
    .inspiration-btn {
      width: 100%;
      padding: 16px 20px;
      background: linear-gradient(135deg, #E60023 0%, #BD081C 100%);
      color: #fff;
      border: none;
      border-radius: var(--radius-md);
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      font-family: inherit;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
      margin-bottom: 8px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      box-shadow: 0 4px 14px rgba(230, 0, 35, 0.25);
      -webkit-transform: translateZ(0);
      text-decoration: none;
    }

    .inspiration-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(230, 0, 35, 0.35);
    }

    .inspiration-btn:active {
      transform: scale(0.98);
    }

    .inspiration-btn svg {
      width: 20px;
      height: 20px;
      fill: currentColor;
    }

    /* Random Picker */
    .picker-section {
      margin: 24px 0;
      animation: fadeInUp 0.6s ease-out 0.15s backwards;
    }

    .picker-card {
      background: var(--picker-bg);
      border-radius: var(--radius-lg);
      padding: 24px;
      color: var(--picker-text);
      position: relative;
      overflow: hidden;
    }

    .picker-card::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
      animation: shimmerBg 3s ease-in-out infinite;
    }

    @keyframes shimmerBg {
      0%, 100% { transform: translate(-30%, -30%); }
      50% { transform: translate(0%, 0%); }
    }

    .picker-content {
      position: relative;
      z-index: 1;
    }

    .picker-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .picker-label {
      font-size: 13px;
      font-weight: 500;
      opacity: 0.7;
    }

    .picker-icon {
      font-size: 24px;
      animation: float 2s ease-in-out infinite;
    }

    .picker-btn {
      width: 100%;
      min-height: 56px;
      padding: 16px 24px;
      background: white;
      color: #1a1a1a;
      border: none;
      border-radius: var(--radius-md);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      font-family: inherit;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      will-change: transform;
      -webkit-transform: translateZ(0);
    }

    .picker-btn-text {
      min-width: 110px;
      text-align: center;
      -webkit-transform: translateZ(0);
    }

    .picker-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.3);
    }

    .picker-btn:active {
      transform: scale(0.97);
    }

    .picker-btn.spinning {
      pointer-events: none;
    }

    .picker-btn-icon {
      font-size: 20px;
      transition: transform 0.3s ease;
    }

    .picker-btn:hover .picker-btn-icon {
      transform: rotate(20deg);
    }

    .picker-btn.spinning .picker-btn-icon {
      animation: spin 0.5s linear infinite;
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    /* Random Result Modal */
    .result-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      z-index: 300;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      animation: fadeIn 0.3s ease-out;
    }

    .result-modal {
      background: var(--bg-card);
      border-radius: var(--radius-xl);
      width: 100%;
      max-width: 360px;
      overflow: hidden;
      animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    @keyframes popIn {
      0% { opacity: 0; transform: scale(0.8); }
      100% { opacity: 1; transform: scale(1); }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }

    .result-spinning .result-image-wrapper {
      animation: shake 0.15s ease-in-out infinite;
    }

    .result-header {
      background: var(--picker-bg);
      color: var(--picker-text);
      padding: 20px;
      text-align: center;
    }

    .result-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(255,255,255,0.2);
      padding: 8px 16px;
      border-radius: 100px;
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .result-title {
      font-size: 24px;
      font-weight: 700;
    }

    .result-image-wrapper {
      position: relative;
      aspect-ratio: 1;
      overflow: hidden;
    }

    .result-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .result-placeholder {
      width: 100%;
      height: 100%;
      min-height: 280px;
      background: var(--accent-soft);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 80px;
    }

    .result-confetti {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 40px;
      animation: confettiFall 1s ease-out forwards;
    }

    @keyframes confettiFall {
      0% { opacity: 1; transform: translateX(-50%) translateY(-20px) scale(1.5); }
      100% { opacity: 0; transform: translateX(-50%) translateY(40px) scale(0.5); }
    }

    .result-info {
      padding: 20px;
      text-align: center;
    }

    .result-outfit-name {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 6px;
      color: var(--text-primary);
    }

    .result-outfit-occasion {
      font-size: 14px;
      color: var(--text-tertiary);
      font-weight: 500;
    }

    .result-actions {
      padding: 0 20px 24px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .result-btn-primary {
      width: 100%;
      padding: 16px;
      background: var(--accent);
      color: var(--bg-card);
      border: none;
      border-radius: var(--radius-md);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      font-family: inherit;
      transition: transform 0.1s ease, opacity 0.1s ease;
      -webkit-tap-highlight-color: transparent;
    }

    .result-btn-primary:hover {
      opacity: 0.9;
    }

    .result-btn-primary:active {
      transform: scale(0.97);
      opacity: 0.85;
    }

    .result-btn-secondary {
      width: 100%;
      padding: 14px;
      background: var(--accent-soft);
      color: var(--text-primary);
      border: none;
      border-radius: var(--radius-md);
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      font-family: inherit;
      transition: transform 0.1s ease, background 0.1s ease;
      -webkit-tap-highlight-color: transparent;
    }

    .result-btn-secondary:hover {
      background: var(--border);
    }

    .result-btn-secondary:active {
      transform: scale(0.97);
      background: var(--border);
    }

    .result-btn-secondary:disabled {
      opacity: 0.6;
      transform: none;
      cursor: not-allowed;
    }

    .result-btn-primary:disabled {
      opacity: 0.6;
      transform: none;
      cursor: not-allowed;
    }

    /* Autocomplete Styles */
    .autocomplete-wrapper {
      position: relative;
      width: 100%;
    }

    .chip-input-container {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      padding: 12px 14px;
      background: var(--bg-card);
      border: 1.5px solid var(--border);
      border-radius: var(--radius-md);
      min-height: 54px;
      align-items: center;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
      cursor: text;
    }

    .chip-input-container:focus-within {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(0,0,0,0.05);
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      background: var(--accent-soft);
      border-radius: 100px;
      font-size: 14px;
      color: var(--text-primary);
      font-weight: 500;
      animation: chipIn 0.2s ease-out;
    }

    @keyframes chipIn {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }

    .chip-remove {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 18px;
      background: var(--text-tertiary);
      color: var(--bg-card);
      border: none;
      border-radius: 50%;
      font-size: 14px;
      line-height: 1;
      cursor: pointer;
      padding: 0;
      transition: background 0.15s ease;
    }

    .chip-remove:hover {
      background: var(--text-secondary);
    }

    .chip-input {
      flex: 1;
      min-width: 100px;
      border: none;
      background: transparent;
      font-size: 16px;
      color: var(--text-primary);
      outline: none;
      padding: 4px 0;
      font-family: inherit;
    }

    .chip-input::placeholder {
      color: var(--text-tertiary);
    }

    .autocomplete-list {
      position: absolute;
      top: calc(100% + 4px);
      left: 0;
      right: 0;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: 4px;
      list-style: none;
      max-height: 220px;
      overflow-y: auto;
      z-index: 1000;
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
      -webkit-overflow-scrolling: touch;
    }

    .autocomplete-item {
      padding: 14px 16px;
      cursor: pointer;
      font-size: 15px;
      color: var(--text-primary);
      border-radius: var(--radius-sm);
      transition: background 0.1s ease;
      text-transform: capitalize;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .autocomplete-item::before {
      content: '→';
      font-size: 12px;
      color: var(--text-tertiary);
      opacity: 0;
      transition: opacity 0.1s ease;
    }

    .autocomplete-item:active,
    .autocomplete-item.highlighted {
      background: var(--accent-soft);
    }

    .autocomplete-item.highlighted::before,
    .autocomplete-item:active::before {
      opacity: 1;
    }

    @media (hover: hover) {
      .autocomplete-item:hover {
        background: var(--accent-soft);
      }
      .autocomplete-item:hover::before {
        opacity: 1;
      }
    }

    .autocomplete-item.user-item {
      background: linear-gradient(135deg, rgba(255,215,0,0.08) 0%, rgba(255,215,0,0.02) 100%);
      border-left: 3px solid #f59e0b;
    }

    .autocomplete-item.user-item::before {
      display: none;
    }

    .autocomplete-item.user-item.highlighted {
      background: linear-gradient(135deg, rgba(255,215,0,0.18) 0%, rgba(255,215,0,0.08) 100%);
    }

    .user-star {
      color: #f59e0b;
      font-size: 11px;
      flex-shrink: 0;
    }

    .autocomplete-text {
      flex: 1;
    }

    .user-item-remove {
      width: 22px;
      height: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(239, 68, 68, 0.1);
      color: #ef4444;
      border: none;
      border-radius: 50%;
      font-size: 16px;
      cursor: pointer;
      padding: 0;
      margin-left: auto;
      opacity: 0.6;
      transition: opacity 0.15s ease, background 0.15s ease;
      flex-shrink: 0;
    }

    .user-item-remove:hover {
      opacity: 1;
      background: rgba(239, 68, 68, 0.2);
    }
  </style>
</head>
<body>
  <script>
    // Apply saved theme immediately to prevent flash
    const savedTheme = localStorage.getItem('theme') || 'standard';
    document.documentElement.setAttribute('data-theme', savedTheme);
  </script>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect, useMemo, useRef } = React;

    // ==========================================
    // MULTILINGUAL CLOTHING VOCABULARY DATABASE
    // ==========================================
    
    // Shared brands (same across all languages)
    const sharedBrands = [
      // Swedish brands
      'acne', 'acne studios', 'cos', 'arket', 'weekday', 'monki', 'h&m', 'hm',
      'filippa k', 'tiger of sweden', 'j lindeberg', 'our legacy', 'toteme', 'ganni',
      'hope', 'rodebjer', 'by malene birger', 'nudie', 'nudie jeans',
      // Fast fashion
      'zara', 'mango', 'massimo dutti', 'pull&bear', 'bershka', 'uniqlo', 'primark',
      'asos', 'na-kd', 'nelly', 'bikbok', 'gina tricot', 'lindex',
      // Sports & Streetwear
      'nike', 'adidas', 'puma', 'reebok', 'new balance', 'asics', 'converse', 'vans',
      'jordan', 'air jordan', 'yeezy', 'under armour', 'champion', 'fila',
      'the north face', 'patagonia', 'columbia', 'fjällräven',
      'carhartt', 'dickies', 'stussy', 'supreme', 'palace', 'bape', 'off-white',
      'stone island', 'moncler', 'canada goose',
      // Premium & Designer
      'ralph lauren', 'tommy hilfiger', 'calvin klein', 'hugo boss', 'gant', 'lacoste',
      'burberry', 'gucci', 'prada', 'louis vuitton', 'balenciaga', 'givenchy',
      'saint laurent', 'versace', 'fendi', 'dior', 'chanel', 'hermes', 'celine',
      // Jeans
      'levis', "levi's", 'lee', 'wrangler', 'diesel', 'replay', 'g-star',
      // Shoes
      'timberland', 'dr martens', 'clarks', 'ecco', 'vagabond', 'birkenstock',
      'ugg', 'blundstone', 'common projects', 'axel arigato', 'golden goose',
      // Watches
      'rolex', 'omega', 'tag heuer', 'cartier', 'daniel wellington', 'casio', 'apple watch'
    ];

    // Special product combos (mostly same across languages)
    const sharedCombos = [
      'nike air max', 'nike air force 1', 'nike dunk', 'air jordan 1',
      'adidas stan smith', 'adidas superstar', 'adidas samba', 'adidas gazelle',
      'new balance 550', 'new balance 990', 'new balance 574',
      'converse chuck taylor', 'vans old skool', 'vans sk8-hi',
      'timberland 6 inch', 'dr martens 1460', 'blundstone 500',
      'levis 501', 'levis 511', 'levis 512',
      'louis vuitton neverfull', 'gucci marmont', 'chanel classic flap',
      'rolex submariner', 'omega speedmaster', 'apple watch'
    ];

    const clothingByLang = {
      sv: {
        colors: ['vit', 'vita', 'svart', 'svarta', 'grå', 'gråa', 'mörkgrå', 'ljusgrå',
          'blå', 'blåa', 'mörkblå', 'marinblå', 'ljusblå', 'navy',
          'röd', 'röda', 'vinröd', 'burgundy', 'grön', 'gröna', 'mörkgrön', 'olivgrön', 'khaki',
          'brun', 'bruna', 'mörkbrun', 'ljusbrun', 'cognac', 'kamel', 'beige', 'tan', 'sand',
          'rosa', 'lila', 'gul', 'orange', 'creme', 'off-white'],
        materials: ['skinn', 'läder', 'mocka', 'denim', 'jeans', 'bomull', 'linne', 'ull', 'kashmir',
          'siden', 'sammet', 'fleece', 'nylon', 'canvas', 'tweed', 'manchester'],
        tops: ['t-shirt', 'tröja', 'skjorta', 'blus', 'hoodie', 'sweatshirt', 'linne', 'polo',
          'kofta', 'cardigan', 'stickad tröja', 'oversize tröja', 'polotröja', 'collegetröja'],
        bottoms: ['jeans', 'byxor', 'chinos', 'shorts', 'kjol', 'kostymbyxor', 'joggers', 'cargobyxor',
          'svarta jeans', 'blå jeans', 'vida byxor', 'slim jeans', 'mom jeans', 'straight jeans'],
        jackets: ['jacka', 'kappa', 'blazer', 'kavaj', 'rock', 'trenchcoat', 'parka',
          'bomberjacka', 'skinnjacka', 'läderjacka', 'jeansjacka', 'dunjacka', 'vinterjacka', 'regnjacka'],
        shoes: ['skor', 'sneakers', 'boots', 'stövlar', 'loafers', 'sandaler', 'klackar',
          'chelsea boots', 'kängor', 'träningsskor', 'löparskor', 'vita sneakers', 'svarta boots'],
        accessories: [
          // Huvud
          'mössa', 'keps', 'hatt', 'basker', 'pannband', 'solhatt',
          // Hals & Scarf
          'halsduk', 'scarf', 'sjal', 'snood', 'bandana',
          // Smycken - Halsband
          'halsband', 'guld halsband', 'silver halsband', 'kedja', 'gulkedja', 'silverkedja', 'pärlhalsband', 'choker',
          // Smycken - Armband
          'armband', 'guld armband', 'silver armband', 'pärlarmband', 'läderarmband', 'tennisarmband', 'berlock',
          // Smycken - Örhängen & Ringar
          'örhängen', 'guld örhängen', 'silver örhängen', 'creoler', 'ring', 'guld ring', 'silver ring', 'signetring',
          // Klockor
          'klocka', 'guld klocka', 'silver klocka', 'svart klocka', 'apple watch', 'smartwatch',
          // Glasögon
          'solglasögon', 'glasögon', 'svarta solglasögon', 'pilotglasögon', 'wayfarers',
          // Väskor
          'väska', 'handväska', 'axelväska', 'crossbody väska', 'tote bag', 'clutch', 'necessär',
          'ryggsäck', 'mini ryggsäck', 'datorväska', 'weekendbag', 'gymbag', 'fannypack', 'midjeväska',
          // Bälten
          'bälte', 'läderbälte', 'svart bälte', 'brunt bälte', 'guld spänne', 'silver spänne',
          // Handskar
          'handskar', 'läderhandskar', 'svarta handskar', 'vantar',
          // Övriga accessoarer
          'plånbok', 'korthållare', 'nyckelring', 'nyckelhänge', 'labubu', 'berlock',
          'airpods', 'airpods fodral', 'mobilskal', 'hårspänne', 'scrunchie', 'hårklämmor'
        ],
        descriptive: ['oversize', 'cropped', 'fitted', 'loose fit', 'slim fit', 'relaxed fit',
          'high waist', 'low waist', 'straight leg', 'wide leg', 'stickad', 'randig', 'rutig']
      },
      en: {
        colors: ['white', 'black', 'grey', 'gray', 'dark grey', 'light grey',
          'blue', 'dark blue', 'navy blue', 'navy', 'light blue', 'sky blue',
          'red', 'dark red', 'burgundy', 'wine red', 'green', 'dark green', 'olive', 'khaki',
          'brown', 'dark brown', 'light brown', 'cognac', 'camel', 'beige', 'tan', 'sand',
          'pink', 'purple', 'yellow', 'orange', 'cream', 'off-white', 'ivory'],
        materials: ['leather', 'suede', 'denim', 'cotton', 'linen', 'wool', 'cashmere',
          'silk', 'velvet', 'fleece', 'nylon', 'canvas', 'tweed', 'corduroy'],
        tops: ['t-shirt', 'tee', 'sweater', 'shirt', 'blouse', 'hoodie', 'sweatshirt', 'tank top',
          'polo', 'cardigan', 'knit sweater', 'oversized sweater', 'turtleneck', 'crewneck'],
        bottoms: ['jeans', 'pants', 'trousers', 'chinos', 'shorts', 'skirt', 'dress pants', 'joggers', 'cargo pants',
          'black jeans', 'blue jeans', 'wide leg pants', 'slim jeans', 'mom jeans', 'straight jeans'],
        jackets: ['jacket', 'coat', 'blazer', 'trench coat', 'parka',
          'bomber jacket', 'leather jacket', 'denim jacket', 'puffer jacket', 'winter jacket', 'rain jacket'],
        shoes: ['shoes', 'sneakers', 'boots', 'loafers', 'sandals', 'heels', 'high heels',
          'chelsea boots', 'ankle boots', 'running shoes', 'trainers', 'white sneakers', 'black boots'],
        accessories: [
          // Head
          'beanie', 'cap', 'hat', 'beret', 'headband', 'sun hat', 'bucket hat',
          // Neck & Scarf
          'scarf', 'shawl', 'snood', 'bandana',
          // Jewelry - Necklaces
          'necklace', 'gold necklace', 'silver necklace', 'chain', 'gold chain', 'silver chain', 'pearl necklace', 'choker', 'pendant',
          // Jewelry - Bracelets
          'bracelet', 'gold bracelet', 'silver bracelet', 'pearl bracelet', 'leather bracelet', 'tennis bracelet', 'charm bracelet', 'bangle',
          // Jewelry - Earrings & Rings
          'earrings', 'gold earrings', 'silver earrings', 'hoops', 'studs', 'ring', 'gold ring', 'silver ring', 'signet ring',
          // Watches
          'watch', 'gold watch', 'silver watch', 'black watch', 'apple watch', 'smartwatch',
          // Eyewear
          'sunglasses', 'glasses', 'aviators', 'wayfarers', 'cat eye sunglasses',
          // Bags
          'bag', 'handbag', 'shoulder bag', 'crossbody bag', 'tote bag', 'clutch', 'pouch',
          'backpack', 'mini backpack', 'laptop bag', 'weekender', 'gym bag', 'fanny pack', 'belt bag',
          // Belts
          'belt', 'leather belt', 'black belt', 'brown belt', 'gold buckle', 'silver buckle',
          // Gloves
          'gloves', 'leather gloves', 'black gloves', 'mittens',
          // Other accessories
          'wallet', 'card holder', 'keychain', 'key ring', 'labubu', 'charm',
          'airpods', 'airpods case', 'phone case', 'hair clip', 'scrunchie', 'hair claw'
        ],
        descriptive: ['oversized', 'cropped', 'fitted', 'loose fit', 'slim fit', 'relaxed fit',
          'high waisted', 'low waisted', 'straight leg', 'wide leg', 'knitted', 'striped', 'plaid']
      },
      es: {
        colors: ['blanco', 'blanca', 'negro', 'negra', 'gris', 'gris oscuro', 'gris claro',
          'azul', 'azul oscuro', 'azul marino', 'azul claro', 'celeste',
          'rojo', 'roja', 'burdeos', 'verde', 'verde oscuro', 'oliva', 'caqui',
          'marrón', 'marrón oscuro', 'marrón claro', 'cognac', 'camel', 'beige', 'arena',
          'rosa', 'morado', 'lila', 'amarillo', 'naranja', 'crema', 'hueso'],
        materials: ['cuero', 'piel', 'ante', 'denim', 'vaquero', 'algodón', 'lino', 'lana', 'cachemira',
          'seda', 'terciopelo', 'polar', 'nylon', 'lona', 'tweed', 'pana'],
        tops: ['camiseta', 'jersey', 'camisa', 'blusa', 'sudadera', 'sudadera con capucha', 'tirantes',
          'polo', 'cárdigan', 'jersey de punto', 'jersey oversize', 'cuello alto'],
        bottoms: ['vaqueros', 'jeans', 'pantalones', 'chinos', 'shorts', 'falda', 'pantalón de vestir', 'joggers',
          'vaqueros negros', 'vaqueros azules', 'pantalón ancho', 'vaqueros slim', 'mom jeans'],
        jackets: ['chaqueta', 'abrigo', 'blazer', 'gabardina', 'parka',
          'bomber', 'chaqueta de cuero', 'chaqueta vaquera', 'plumas', 'chaqueta de invierno'],
        shoes: ['zapatos', 'zapatillas', 'botas', 'mocasines', 'sandalias', 'tacones',
          'botines', 'botas chelsea', 'deportivas', 'zapatillas blancas', 'botas negras'],
        accessories: [
          // Cabeza
          'gorro', 'gorra', 'sombrero', 'boina', 'diadema', 'sombrero de sol',
          // Cuello & Bufanda
          'bufanda', 'chal', 'pañuelo', 'bandana',
          // Joyería - Collares
          'collar', 'collar de oro', 'collar de plata', 'cadena', 'cadena de oro', 'cadena de plata', 'collar de perlas', 'gargantilla', 'colgante',
          // Joyería - Pulseras
          'pulsera', 'pulsera de oro', 'pulsera de plata', 'pulsera de perlas', 'pulsera de cuero', 'pulsera de tenis', 'brazalete',
          // Joyería - Pendientes & Anillos
          'pendientes', 'pendientes de oro', 'pendientes de plata', 'aros', 'anillo', 'anillo de oro', 'anillo de plata', 'sello',
          // Relojes
          'reloj', 'reloj de oro', 'reloj de plata', 'reloj negro', 'apple watch', 'smartwatch',
          // Gafas
          'gafas de sol', 'gafas', 'aviadores', 'wayfarers',
          // Bolsos
          'bolso', 'bolso de mano', 'bolso de hombro', 'bandolera', 'tote bag', 'clutch', 'neceser',
          'mochila', 'mini mochila', 'bolsa de portátil', 'bolsa de fin de semana', 'bolsa de deporte', 'riñonera',
          // Cinturones
          'cinturón', 'cinturón de cuero', 'cinturón negro', 'cinturón marrón', 'hebilla dorada', 'hebilla plateada',
          // Guantes
          'guantes', 'guantes de cuero', 'guantes negros', 'manoplas',
          // Otros accesorios
          'cartera', 'tarjetero', 'llavero', 'labubu', 'charm',
          'airpods', 'funda de airpods', 'funda de móvil', 'pinza de pelo', 'scrunchie', 'horquilla'
        ],
        descriptive: ['oversize', 'crop', 'ajustado', 'holgado', 'slim fit', 'relaxed fit',
          'tiro alto', 'tiro bajo', 'recto', 'ancho', 'punto', 'rayas', 'cuadros']
      }
    };

    // Generate category-specific suggestions for a language
    const generateSuggestionsByCategory = (lang) => {
      const db = clothingByLang[lang] || clothingByLang.sv;
      const popularBrands = ['nike', 'adidas', 'zara', 'h&m', 'cos', 'weekday', 'levis', 'acne', 'uniqlo', 'mango'];
      const accessoryBrands = ['michael kors', 'louis vuitton', 'gucci', 'prada', 'chanel', 'dior', 'hermes', 'coach', 'marc jacobs', 'tory burch', 'furla', 'kate spade', 'ray-ban', 'oakley', 'daniel wellington', 'rolex', 'omega', 'apple watch', 'pandora', 'swarovski', 'tiffany'];
      
      const createCategorySuggestions = (items, includeColors = true, includeMaterials = false, brands = popularBrands) => {
        const suggestions = new Set();
        
        // Add base items
        items.forEach(item => suggestions.add(item.toLowerCase()));
        
        // Add color + item combos
        if (includeColors) {
          db.colors.forEach(color => {
            items.forEach(item => {
              suggestions.add(`${color} ${item}`);
            });
          });
        }
        
        // Add material + item combos
        if (includeMaterials) {
          db.materials.forEach(material => {
            items.forEach(item => {
              suggestions.add(`${material} ${item}`);
            });
          });
        }
        
        // Add brand + item combos
        brands.forEach(brand => {
          items.forEach(item => {
            suggestions.add(`${brand} ${item}`);
          });
        });
        
        // Add descriptive + item combos
        db.descriptive.forEach(desc => {
          items.forEach(item => {
            suggestions.add(`${desc} ${item}`);
          });
        });
        
        return Array.from(suggestions).sort();
      };
      
      return {
        top: createCategorySuggestions(db.tops, true, true),
        bottom: createCategorySuggestions(db.bottoms, true, true),
        jacket: createCategorySuggestions(db.jackets, true, true),
        shoes: [
          ...createCategorySuggestions(db.shoes, true, true),
          ...sharedCombos.filter(c => c.includes('nike') || c.includes('adidas') || c.includes('new balance') || c.includes('converse') || c.includes('vans') || c.includes('timberland') || c.includes('dr martens') || c.includes('blundstone'))
        ],
        accessories: [
          ...createCategorySuggestions(db.accessories, true, true, accessoryBrands),
          ...sharedCombos.filter(c => c.includes('louis vuitton') || c.includes('gucci') || c.includes('chanel') || c.includes('rolex') || c.includes('omega') || c.includes('apple watch'))
        ]
      };
    };

    // Pre-generate suggestions for all languages by category
    const suggestionsByLangAndCategory = {
      sv: generateSuggestionsByCategory('sv'),
      en: generateSuggestionsByCategory('en'),
      es: generateSuggestionsByCategory('es')
    };


    // Multi-chip Autocomplete Component
    function AutoComplete({ value, onChange, placeholder, lang = 'sv', fieldType = 'top', userItems = [], onRemoveUserItem }) {
      const allCategories = suggestionsByLangAndCategory[lang] || suggestionsByLangAndCategory.sv;
      const suggestions = allCategories[fieldType] || [];
      const [inputValue, setInputValue] = useState('');
      const [isOpen, setIsOpen] = useState(false);
      const [filtered, setFiltered] = useState([]);
      const [highlightIndex, setHighlightIndex] = useState(0);
      const inputRef = useRef(null);
      const listRef = useRef(null);

      // Parse chips from value (comma separated)
      const chips = value ? value.split(',').map(s => s.trim()).filter(s => s.length > 0) : [];

      useEffect(() => {
        if (inputValue && inputValue.length >= 1) {
          const query = inputValue.toLowerCase().trim();
          
          // First search user's own items
          const userMatches = userItems
            .filter(s => s.toLowerCase().includes(query))
            .filter(s => !chips.some(c => c.toLowerCase() === s.toLowerCase())) // Exclude already added
            .sort((a, b) => {
              const aStarts = a.toLowerCase().startsWith(query);
              const bStarts = b.toLowerCase().startsWith(query);
              if (aStarts && !bStarts) return -1;
              if (!aStarts && bStarts) return 1;
              return a.length - b.length;
            })
            .slice(0, 4)
            .map(s => ({ text: s, isUser: true }));
          
          // Then search standard suggestions
          const startsWithMatches = [];
          const wordStartsWithMatches = [];
          const includesMatches = [];
          
          suggestions.forEach(s => {
            // Skip if already in user matches or already added as chip
            if (userItems.some(u => u.toLowerCase() === s.toLowerCase())) return;
            if (chips.some(c => c.toLowerCase() === s.toLowerCase())) return;
            
            const lower = s.toLowerCase();
            if (lower.startsWith(query)) {
              startsWithMatches.push(s);
            } else if (lower.split(' ').some(word => word.startsWith(query))) {
              wordStartsWithMatches.push(s);
            } else if (lower.includes(query)) {
              includesMatches.push(s);
            }
          });
          
          const sortByLength = (a, b) => a.length - b.length;
          startsWithMatches.sort(sortByLength);
          wordStartsWithMatches.sort(sortByLength);
          includesMatches.sort(sortByLength);
          
          const standardMatches = [...startsWithMatches, ...wordStartsWithMatches, ...includesMatches]
            .slice(0, 8 - userMatches.length)
            .map(s => ({ text: s, isUser: false }));
          
          const matches = [...userMatches, ...standardMatches];
          
          setFiltered(matches);
          setIsOpen(matches.length > 0);
          setHighlightIndex(0);
        } else {
          setIsOpen(false);
          setFiltered([]);
        }
      }, [inputValue, suggestions, userItems, chips]);

      const addChip = (text) => {
        const formatted = text.charAt(0).toUpperCase() + text.slice(1);
        if (chips.some(c => c.toLowerCase() === formatted.toLowerCase())) return;
        const newChips = [...chips, formatted];
        onChange(newChips.join(', '));
        setInputValue('');
        setIsOpen(false);
      };

      const removeChip = (index) => {
        const newChips = chips.filter((_, i) => i !== index);
        onChange(newChips.join(', '));
      };

      const handleSelect = (item) => {
        const text = item.text || item;
        addChip(text);
        inputRef.current?.focus();
      };

      const handleKeyDown = (e) => {
        if (e.key === 'Enter' && inputValue.trim()) {
          e.preventDefault();
          if (isOpen && filtered[highlightIndex]) {
            handleSelect(filtered[highlightIndex]);
          } else {
            addChip(inputValue.trim());
          }
        } else if (e.key === 'Backspace' && !inputValue && chips.length > 0) {
          removeChip(chips.length - 1);
        } else if (e.key === 'ArrowDown' && isOpen) {
          e.preventDefault();
          setHighlightIndex(i => Math.min(i + 1, filtered.length - 1));
        } else if (e.key === 'ArrowUp' && isOpen) {
          e.preventDefault();
          setHighlightIndex(i => Math.max(i - 1, 0));
        } else if (e.key === 'Escape') {
          setIsOpen(false);
        } else if (e.key === 'Tab' && isOpen && filtered[highlightIndex]) {
          e.preventDefault();
          handleSelect(filtered[highlightIndex]);
        }
      };

      const handleRemoveUserItem = (e, text) => {
        e.stopPropagation();
        e.preventDefault();
        if (onRemoveUserItem) {
          onRemoveUserItem(text);
        }
      };

      return (
        <div className="autocomplete-wrapper">
          <div className="chip-input-container">
            {chips.map((chip, index) => (
              <span key={index} className="chip">
                {chip}
                <button 
                  type="button" 
                  className="chip-remove" 
                  onClick={() => removeChip(index)}
                >
                  ×
                </button>
              </span>
            ))}
            <input
              ref={inputRef}
              type="text"
              value={inputValue}
              onChange={(e) => setInputValue(e.target.value)}
              onKeyDown={handleKeyDown}
              onFocus={() => inputValue && inputValue.length >= 1 && filtered.length > 0 && setIsOpen(true)}
              onBlur={() => setTimeout(() => setIsOpen(false), 200)}
              placeholder={chips.length === 0 ? placeholder : ''}
              autoComplete="off"
              autoCorrect="off"
              autoCapitalize="off"
              spellCheck="false"
              className="chip-input"
            />
          </div>
          {isOpen && filtered.length > 0 && (
            <ul className="autocomplete-list" ref={listRef}>
              {filtered.map((item, index) => (
                <li
                  key={item.text || item}
                  className={`autocomplete-item ${index === highlightIndex ? 'highlighted' : ''} ${item.isUser ? 'user-item' : ''}`}
                  onMouseDown={() => handleSelect(item)}
                  onMouseEnter={() => setHighlightIndex(index)}
                >
                  {item.isUser && <span className="user-star">★</span>}
                  <span className="autocomplete-text">{item.text || item}</span>
                  {item.isUser && onRemoveUserItem && (
                    <button 
                      type="button"
                      className="user-item-remove"
                      onMouseDown={(e) => handleRemoveUserItem(e, item.text)}
                    >
                      ×
                    </button>
                  )}
                </li>
              ))}
            </ul>
          )}
        </div>
      );
    }

    const translations = {
      sv: {
        greeting: { morning: 'God morgon', afternoon: 'God eftermiddag', evening: 'God kväll', night: 'God natt' },
        title: 'Garderob.',
        appName: 'Garderob.',
        total: 'Totalt',
        thisWeek: 'Denna vecka',
        favorites: 'Favoriter',
        filter: 'Filtrera',
        all: 'Alla',
        yourOutfits: 'Dina outfits',
        outfits: 'outfits',
        newOutfit: 'Ny outfit',
        editOutfit: 'Redigera outfit',
        outfitName: 'Namn',
        selectOccasion: 'Välj tillfälle',
        top: 'Överdel',
        bottom: 'Underdel',
        jacket: 'Jacka',
        shoes: 'Skor',
        accessories: 'Accessoarer',
        addImage: 'Lägg till bild',
        cancel: 'Avbryt',
        save: 'Spara outfit',
        update: 'Uppdatera',
        delete: 'Radera outfit',
        edit: 'Redigera',
        back: 'Tillbaka',
        noOutfits: 'Din garderob är tom',
        pressToStart: 'Lägg till din första outfit och börja bygga din stilguide',
        addFirst: 'Lägg till outfit',
        items: 'plagg',
        details: 'Detaljer',
        cantDecide: 'Kan inte välja?',
        pickForMe: 'Välj åt mig',
        spinning: 'Väljer...',
        todaysPick: 'Dagens val',
        wearThis: 'Kör på denna!',
        tryAgain: 'Slumpa igen',
        wearToday: 'Bär idag',
        lastWorn: 'Senast',
        daysAgo: 'dagar sen',
        today: 'Idag',
        yesterday: 'Igår',
        neverWorn: 'Aldrig använd',
        confirmDelete: 'Radera outfit?',
        confirmDeleteText: 'Är du säker? Detta går inte att ångra.',
        yes: 'Ja, radera',
        no: 'Avbryt',
        worn: 'Använd!',
        undoWear: 'Ångra',
        inspiration: 'Se inspiration på Pinterest',
        settings: 'Inställningar',
        yourName: 'Ditt namn',
        yourNamePlaceholder: 'Skriv ditt namn',
        yourCity: 'Din stad',
        yourCityPlaceholder: 'T.ex. Stockholm',
        resetAll: 'Börja om',
        resetAllDesc: 'Raderar alla outfits och sparade plagg',
        resetConfirm: 'Börja om?',
        resetConfirmText: 'Detta raderar alla dina outfits och sparade plagg. Kan inte ångras.',
        resetYes: 'Ja, börja om',
        weatherTip: {
          freezing: 'Kallt! Dags för vinterjacka 🥶',
          cold: 'Ta på dig en varm jacka',
          cool: 'En lätt jacka passar bra',
          warm: 'Perfekt väder utan jacka ☀️'
        },
        occasions: ['Vardag', 'Jobb', 'Fest', 'Date', 'Träning', 'Annat'],
        chooseTheme: 'Välj tema',
        chooseThemeSubtitle: 'Anpassa din upplevelse',
        themes: { standard: 'Standard', rose: 'Rosa', sky: 'Himmel', mint: 'Mint', lavender: 'Lavendel', peach: 'Persika', lemon: 'Citron', dark: 'Mörkt' }
      },
      en: {
        greeting: { morning: 'Good morning', afternoon: 'Good afternoon', evening: 'Good evening', night: 'Good night' },
        title: 'Garderob.',
        appName: 'Wardrobe.',
        total: 'Total',
        thisWeek: 'This week',
        favorites: 'Favorites',
        filter: 'Filter',
        all: 'All',
        yourOutfits: 'Your outfits',
        outfits: 'outfits',
        newOutfit: 'New outfit',
        editOutfit: 'Edit outfit',
        outfitName: 'Name',
        selectOccasion: 'Select occasion',
        top: 'Top',
        bottom: 'Bottom',
        jacket: 'Jacket',
        shoes: 'Shoes',
        accessories: 'Accessories',
        addImage: 'Add image',
        cancel: 'Cancel',
        save: 'Save outfit',
        update: 'Update',
        delete: 'Delete outfit',
        edit: 'Edit',
        back: 'Back',
        noOutfits: 'Your wardrobe is empty',
        pressToStart: 'Add your first outfit and start building your style guide',
        addFirst: 'Add outfit',
        items: 'items',
        details: 'Details',
        cantDecide: "Can't decide?",
        pickForMe: 'Pick for me',
        spinning: 'Picking...',
        todaysPick: "Today's pick",
        wearThis: 'Wear this one!',
        tryAgain: 'Try again',
        wearToday: 'Wear today',
        lastWorn: 'Last worn',
        daysAgo: 'days ago',
        today: 'Today',
        yesterday: 'Yesterday',
        neverWorn: 'Never worn',
        confirmDelete: 'Delete outfit?',
        confirmDeleteText: 'Are you sure? This cannot be undone.',
        yes: 'Yes, delete',
        no: 'Cancel',
        worn: 'Worn!',
        undoWear: 'Undo',
        inspiration: 'Get inspiration on Pinterest',
        settings: 'Settings',
        yourName: 'Your name',
        yourNamePlaceholder: 'Enter your name',
        yourCity: 'Your city',
        yourCityPlaceholder: 'E.g. London',
        resetAll: 'Start over',
        resetAllDesc: 'Deletes all outfits and saved items',
        resetConfirm: 'Start over?',
        resetConfirmText: 'This will delete all your outfits and saved items. Cannot be undone.',
        resetYes: 'Yes, start over',
        weatherTip: {
          freezing: 'Freezing! Time for a winter jacket 🥶',
          cold: 'Wear a warm jacket',
          cool: 'A light jacket works well',
          warm: 'Perfect weather without a jacket ☀️'
        },
        occasions: ['Everyday', 'Work', 'Party', 'Date', 'Workout', 'Other'],
        chooseTheme: 'Choose theme',
        chooseThemeSubtitle: 'Customize your experience',
        themes: { standard: 'Standard', rose: 'Rose', sky: 'Sky', mint: 'Mint', lavender: 'Lavender', peach: 'Peach', lemon: 'Lemon', dark: 'Dark' }
      },
      es: {
        greeting: { morning: 'Buenos días', afternoon: 'Buenas tardes', evening: 'Buenas noches', night: 'Buenas noches' },
        title: 'Garderob.',
        appName: 'Armario.',
        total: 'Total',
        thisWeek: 'Esta semana',
        favorites: 'Favoritos',
        filter: 'Filtrar',
        all: 'Todo',
        yourOutfits: 'Tus outfits',
        outfits: 'outfits',
        newOutfit: 'Nuevo outfit',
        editOutfit: 'Editar outfit',
        outfitName: 'Nombre',
        selectOccasion: 'Seleccionar ocasión',
        top: 'Parte superior',
        bottom: 'Parte inferior',
        jacket: 'Chaqueta',
        shoes: 'Zapatos',
        accessories: 'Accesorios',
        addImage: 'Añadir imagen',
        cancel: 'Cancelar',
        save: 'Guardar outfit',
        update: 'Actualizar',
        delete: 'Eliminar outfit',
        edit: 'Editar',
        back: 'Volver',
        noOutfits: 'Tu armario está vacío',
        pressToStart: 'Añade tu primer outfit y empieza a crear tu guía de estilo',
        addFirst: 'Añadir outfit',
        items: 'prendas',
        details: 'Detalles',
        cantDecide: '¿No puedes decidir?',
        pickForMe: 'Elige por mí',
        spinning: 'Eligiendo...',
        todaysPick: 'Elección del día',
        wearThis: '¡Ponte este!',
        tryAgain: 'Intentar de nuevo',
        wearToday: 'Usar hoy',
        lastWorn: 'Último uso',
        daysAgo: 'días',
        today: 'Hoy',
        yesterday: 'Ayer',
        neverWorn: 'Nunca usado',
        confirmDelete: '¿Eliminar outfit?',
        confirmDeleteText: '¿Estás seguro? Esto no se puede deshacer.',
        yes: 'Sí, eliminar',
        no: 'Cancelar',
        worn: '¡Usado!',
        undoWear: 'Deshacer',
        inspiration: 'Ver inspiración en Pinterest',
        settings: 'Ajustes',
        yourName: 'Tu nombre',
        yourNamePlaceholder: 'Escribe tu nombre',
        yourCity: 'Tu ciudad',
        yourCityPlaceholder: 'Ej. Madrid',
        resetAll: 'Empezar de nuevo',
        resetAllDesc: 'Elimina todos los outfits y prendas guardadas',
        resetConfirm: '¿Empezar de nuevo?',
        resetConfirmText: 'Esto eliminará todos tus outfits y prendas guardadas. No se puede deshacer.',
        resetYes: 'Sí, empezar de nuevo',
        weatherTip: {
          freezing: '¡Frío! Hora de la chaqueta de invierno 🥶',
          cold: 'Ponte una chaqueta abrigada',
          cool: 'Una chaqueta ligera va bien',
          warm: 'Tiempo perfecto sin chaqueta ☀️'
        },
        occasions: ['Diario', 'Trabajo', 'Fiesta', 'Cita', 'Ejercicio', 'Otro'],
        chooseTheme: 'Elegir tema',
        chooseThemeSubtitle: 'Personaliza tu experiencia',
        themes: { standard: 'Estándar', rose: 'Rosa', sky: 'Cielo', mint: 'Menta', lavender: 'Lavanda', peach: 'Melocotón', lemon: 'Limón', dark: 'Oscuro' }
      }
    };

    function getGreeting(t) {
      // Get Stockholm time
      const stockholmTime = new Date().toLocaleString('en-US', { timeZone: 'Europe/Stockholm' });
      const hour = new Date(stockholmTime).getHours();
      
      if (hour >= 5 && hour < 12) return t.greeting.morning;      // 05:00 - 11:59
      if (hour >= 12 && hour < 17) return t.greeting.afternoon;   // 12:00 - 16:59
      if (hour >= 17 && hour < 22) return t.greeting.evening;     // 17:00 - 21:59
      return t.greeting.night;                                      // 22:00 - 04:59
    }

    function countItems(outfit) {
      let count = 0;
      if (outfit.top) count++;
      if (outfit.bottom) count++;
      if (outfit.jacket) count++;
      if (outfit.shoes) count++;
      if (outfit.accessories) count++;
      return count;
    }

    function getPinterestUrl(outfit) {
      // Collect all outfit parts
      const parts = [
        outfit.top,
        outfit.bottom,
        outfit.jacket,
        outfit.shoes,
        outfit.accessories
      ].filter(Boolean);
      
      // Create search query
      const query = parts.join(' ') + ' outfit';
      const encodedQuery = encodeURIComponent(query);
      
      return `https://pinterest.com/search/pins/?q=${encodedQuery}`;
    }

    function OutfitApp() {
      const [lang, setLang] = useState(() => localStorage.getItem('lang') || 'sv');
      const [theme, setTheme] = useState(() => localStorage.getItem('theme') || 'standard');
      const [showThemeModal, setShowThemeModal] = useState(false);
      const t = translations[lang];

      const [outfits, setOutfits] = useState(() => {
        const saved = localStorage.getItem('outfits');
        return saved ? JSON.parse(saved) : [];
      });

      // User's saved clothing items (personalized suggestions)
      const [userClothing, setUserClothing] = useState(() => {
        const saved = localStorage.getItem('userClothing');
        return saved ? JSON.parse(saved) : [];
      });

      // Settings
      const [showSettings, setShowSettings] = useState(false);
      const [showResetConfirm, setShowResetConfirm] = useState(false);
      const [userName, setUserName] = useState(() => localStorage.getItem('userName') || '');
      const [userCity, setUserCity] = useState(() => localStorage.getItem('userCity') || '');
      const [weather, setWeather] = useState(null);

      const [showForm, setShowForm] = useState(false);
      const [selectedOutfit, setSelectedOutfit] = useState(null);
      const [editingOutfit, setEditingOutfit] = useState(null);
      const [activeFilter, setActiveFilter] = useState('all');
      const [isSpinning, setIsSpinning] = useState(false);
      const [randomResult, setRandomResult] = useState(null);
      const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);
      const [newOutfit, setNewOutfit] = useState({
        name: '', top: '', bottom: '', jacket: '', shoes: '', accessories: '', occasion: '', image: null
      });

      const occasions = t.occasions;

      useEffect(() => {
        localStorage.setItem('outfits', JSON.stringify(outfits));
      }, [outfits]);

      useEffect(() => {
        localStorage.setItem('userClothing', JSON.stringify(userClothing));
      }, [userClothing]);

      useEffect(() => {
        localStorage.setItem('lang', lang);
      }, [lang]);

      useEffect(() => {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
      }, [theme]);

      // Save userName to localStorage
      useEffect(() => {
        localStorage.setItem('userName', userName);
      }, [userName]);

      // Save userCity and fetch weather
      useEffect(() => {
        localStorage.setItem('userCity', userCity);
        if (userCity.trim()) {
          fetchWeather(userCity);
        } else {
          setWeather(null);
        }
      }, [userCity]);

      // Fetch weather from Open-Meteo
      const fetchWeather = async (city) => {
        try {
          // First get coordinates from city name
          const geoRes = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(city)}&count=1`);
          const geoData = await geoRes.json();
          
          if (geoData.results && geoData.results[0]) {
            const { latitude, longitude } = geoData.results[0];
            
            // Then get weather
            const weatherRes = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,weather_code`);
            const weatherData = await weatherRes.json();
            
            if (weatherData.current) {
              setWeather({
                temp: Math.round(weatherData.current.temperature_2m),
                code: weatherData.current.weather_code
              });
            }
          }
        } catch (err) {
          console.log('Weather fetch failed:', err);
          setWeather(null);
        }
      };

      // Get weather icon based on WMO code
      const getWeatherIcon = (code) => {
        if (code === 0) return '☀️';
        if (code <= 3) return '⛅';
        if (code <= 48) return '☁️';
        if (code <= 67) return '🌧️';
        if (code <= 77) return '🌨️';
        if (code <= 82) return '🌧️';
        if (code <= 86) return '🌨️';
        if (code >= 95) return '⛈️';
        return '🌡️';
      };

      // Get weather tip based on temperature
      const getWeatherTip = (temp) => {
        if (temp < 0) return t.weatherTip.freezing;
        if (temp < 10) return t.weatherTip.cold;
        if (temp < 18) return t.weatherTip.cool;
        return t.weatherTip.warm;
      };

      // Reset all data
      const resetAllData = () => {
        setOutfits([]);
        setUserClothing([]);
        setShowResetConfirm(false);
        setShowSettings(false);
      };

      const themes = ['standard', 'rose', 'sky', 'mint', 'lavender', 'peach', 'lemon', 'dark'];

      const filteredOutfits = useMemo(() => {
        if (activeFilter === 'all') return outfits;
        if (activeFilter === 'favorites') return outfits.filter(o => o.isFavorite);
        return outfits.filter(o => o.occasion === activeFilter);
      }, [outfits, activeFilter]);

      const handleImageUpload = (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onloadend = () => {
            // Compress image to prevent crashes
            const img = new Image();
            img.onload = () => {
              const canvas = document.createElement('canvas');
              const maxSize = 800; // Max width/height
              let width = img.width;
              let height = img.height;
              
              if (width > height && width > maxSize) {
                height = (height * maxSize) / width;
                width = maxSize;
              } else if (height > maxSize) {
                width = (width * maxSize) / height;
                height = maxSize;
              }
              
              canvas.width = width;
              canvas.height = height;
              const ctx = canvas.getContext('2d');
              ctx.drawImage(img, 0, 0, width, height);
              
              const compressedImage = canvas.toDataURL('image/jpeg', 0.7);
              setNewOutfit(prev => ({ ...prev, image: compressedImage }));
            };
            img.src = reader.result;
          };
          reader.readAsDataURL(file);
        }
      };

      // Save clothing items from outfit to user's personal list
      const saveClothingItems = (outfit) => {
        const items = [outfit.top, outfit.bottom, outfit.jacket, outfit.shoes, outfit.accessories]
          .filter(item => item && item.trim().length > 1)
          .map(item => item.trim().toLowerCase());
        
        setUserClothing(prev => {
          const newItems = items.filter(item => !prev.includes(item));
          if (newItems.length === 0) return prev;
          // Keep max 100 items, newest first
          return [...newItems, ...prev].slice(0, 100);
        });
      };

      // Remove item from user's personal list
      const removeUserItem = (item) => {
        if (!item) return;
        const normalizedItem = item.trim().toLowerCase();
        setUserClothing(prev => prev.filter(i => i.toLowerCase() !== normalizedItem));
      };

      const addOutfit = () => {
        if (newOutfit.name) {
          saveClothingItems(newOutfit);
          setOutfits([{ ...newOutfit, id: Date.now(), createdAt: new Date().toISOString() }, ...outfits]);
          setNewOutfit({ name: '', top: '', bottom: '', jacket: '', shoes: '', accessories: '', occasion: '', image: null });
          setShowForm(false);
        }
      };

      const startEdit = (outfit) => {
        setEditingOutfit(outfit);
        setNewOutfit({
          name: outfit.name,
          top: outfit.top || '',
          bottom: outfit.bottom || '',
          jacket: outfit.jacket || '',
          shoes: outfit.shoes || '',
          accessories: outfit.accessories || '',
          occasion: outfit.occasion || '',
          image: outfit.image || null
        });
        setSelectedOutfit(null);
        setShowForm(true);
      };

      const updateOutfit = () => {
        if (newOutfit.name && editingOutfit) {
          saveClothingItems(newOutfit);
          setOutfits(outfits.map(o => 
            o.id === editingOutfit.id 
              ? { ...o, ...newOutfit }
              : o
          ));
          setNewOutfit({ name: '', top: '', bottom: '', jacket: '', shoes: '', accessories: '', occasion: '', image: null });
          setEditingOutfit(null);
          setShowForm(false);
        }
      };

      const cancelEdit = () => {
        setNewOutfit({ name: '', top: '', bottom: '', jacket: '', shoes: '', accessories: '', occasion: '', image: null });
        setEditingOutfit(null);
        setShowForm(false);
      };

      const deleteOutfit = (id) => {
        setOutfits(outfits.filter(o => o.id !== id));
        setSelectedOutfit(null);
        setShowDeleteConfirm(false);
      };

      const toggleFavorite = (id) => {
        setOutfits(outfits.map(o => 
          o.id === id ? { ...o, isFavorite: !o.isFavorite } : o
        ));
      };

      const wearToday = (id, currentLastWorn) => {
        const isWornToday = getDaysSinceWorn(currentLastWorn) === 0;
        setOutfits(outfits.map(o => 
          o.id === id ? { ...o, lastWorn: isWornToday ? null : new Date().toISOString() } : o
        ));
      };

      const getDaysSinceWorn = (lastWorn) => {
        if (!lastWorn) return null;
        const days = Math.floor((new Date() - new Date(lastWorn)) / (1000 * 60 * 60 * 24));
        return days;
      };

      const cycleLang = () => {
        const langs = ['sv', 'en', 'es'];
        const next = langs[(langs.indexOf(lang) + 1) % langs.length];
        setLang(next);
      };

      const pickRandom = () => {
        if (filteredOutfits.length < 2) return;
        
        // If already showing result (retry), make it faster
        const isRetry = randomResult !== null;
        const maxSpins = isRetry ? 6 : 12;
        const spinSpeed = isRetry ? 40 : 70;
        
        setIsSpinning(true);
        
        let spins = 0;
        const spinInterval = setInterval(() => {
          spins++;
          if (spins >= maxSpins) {
            clearInterval(spinInterval);
            // Make sure we get a different outfit on retry
            let randomIndex;
            if (isRetry && filteredOutfits.length > 1) {
              const currentIndex = filteredOutfits.findIndex(o => o.id === randomResult.id);
              do {
                randomIndex = Math.floor(Math.random() * filteredOutfits.length);
              } while (randomIndex === currentIndex);
            } else {
              randomIndex = Math.floor(Math.random() * filteredOutfits.length);
            }
            setRandomResult(filteredOutfits[randomIndex]);
            setIsSpinning(false);
          }
        }, spinSpeed);
      };

      const closeResult = () => {
        setRandomResult(null);
      };

      const viewRandomResult = () => {
        if (randomResult) {
          setSelectedOutfit(randomResult.id);
          setRandomResult(null);
        }
      };

      // Detail View
      if (selectedOutfit) {
        const outfit = outfits.find(o => o.id === selectedOutfit);
        if (!outfit) return null;

        const daysSince = getDaysSinceWorn(outfit.lastWorn);
        const lastWornText = daysSince === null ? t.neverWorn :
                            daysSince === 0 ? t.today :
                            daysSince === 1 ? t.yesterday :
                            `${daysSince} ${t.daysAgo}`;

        return (
          <div className="detail">
            <div className="detail-back-wrapper">
              <button onClick={() => setSelectedOutfit(null)} className="detail-back">←</button>
            </div>
            <button 
              className={`detail-favorite ${outfit.isFavorite ? 'active' : ''}`}
              onClick={() => toggleFavorite(outfit.id)}
            >
              {outfit.isFavorite ? '❤️' : '🤍'}
            </button>
            <div className="detail-scroll">
              <div className="detail-hero">
                {outfit.image ? (
                  <img src={outfit.image} alt={outfit.name} className="detail-image" />
                ) : (
                  <div className="detail-no-image">👔</div>
                )}
                <div className="detail-hero-overlay" />
                <div className="detail-hero-content">
                  <h1 className="detail-title">{outfit.name}</h1>
                  {outfit.occasion && <span className="detail-tag">{outfit.occasion}</span>}
                </div>
              </div>

              <div className="detail-content">
              <div className="detail-last-worn">
                <span className="detail-last-worn-icon">📅</span>
                <span>{t.lastWorn}: {lastWornText}</span>
              </div>

              <button 
                className={`wear-today-btn ${daysSince === 0 ? 'worn' : ''}`}
                onClick={() => wearToday(outfit.id, outfit.lastWorn)}
              >
                {daysSince === 0 ? `↩ ${t.undoWear}` : `👕 ${t.wearToday}`}
              </button>

              <p className="detail-section-title">{t.details}</p>
              <div className="detail-items">
                {outfit.top && (
                  <div className="detail-item">
                    <div className="detail-item-icon">👕</div>
                    <div><p className="detail-item-label">{t.top}</p><p className="detail-item-value">{outfit.top}</p></div>
                  </div>
                )}
                {outfit.bottom && (
                  <div className="detail-item">
                    <div className="detail-item-icon">👖</div>
                    <div><p className="detail-item-label">{t.bottom}</p><p className="detail-item-value">{outfit.bottom}</p></div>
                  </div>
                )}
                {outfit.jacket && (
                  <div className="detail-item">
                    <div className="detail-item-icon">🧥</div>
                    <div><p className="detail-item-label">{t.jacket}</p><p className="detail-item-value">{outfit.jacket}</p></div>
                  </div>
                )}
                {outfit.shoes && (
                  <div className="detail-item">
                    <div className="detail-item-icon">👟</div>
                    <div><p className="detail-item-label">{t.shoes}</p><p className="detail-item-value">{outfit.shoes}</p></div>
                  </div>
                )}
                {outfit.accessories && (
                  <div className="detail-item">
                    <div className="detail-item-icon">💍</div>
                    <div><p className="detail-item-label">{t.accessories}</p><p className="detail-item-value">{outfit.accessories}</p></div>
                  </div>
                )}
              </div>

              {/* Pinterest Inspiration */}
              <a 
                href={getPinterestUrl(outfit)} 
                target="_blank" 
                rel="noopener noreferrer" 
                className="inspiration-btn"
              >
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 0C5.373 0 0 5.373 0 12c0 5.084 3.163 9.426 7.627 11.174-.105-.949-.2-2.405.042-3.441.218-.937 1.407-5.965 1.407-5.965s-.359-.719-.359-1.782c0-1.668.967-2.914 2.171-2.914 1.023 0 1.518.769 1.518 1.69 0 1.029-.655 2.568-.994 3.995-.283 1.194.599 2.169 1.777 2.169 2.133 0 3.772-2.249 3.772-5.495 0-2.873-2.064-4.882-5.012-4.882-3.414 0-5.418 2.561-5.418 5.207 0 1.031.397 2.138.893 2.738.098.119.112.224.083.345l-.333 1.36c-.053.22-.174.267-.402.161-1.499-.698-2.436-2.889-2.436-4.649 0-3.785 2.75-7.262 7.929-7.262 4.163 0 7.398 2.967 7.398 6.931 0 4.136-2.607 7.464-6.227 7.464-1.216 0-2.359-.632-2.75-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146C9.57 23.812 10.763 24 12 24c6.627 0 12-5.373 12-12S18.627 0 12 0z"/>
                </svg>
                {t.inspiration}
              </a>

              <div className="detail-actions">
                <button onClick={() => startEdit(outfit)} className="edit-btn">{t.edit}</button>
                <button onClick={() => setShowDeleteConfirm(true)} className="delete-btn">{t.delete}</button>
              </div>
            </div>
            </div>

            {/* Delete Confirmation Modal */}
            {showDeleteConfirm && (
              <div className="confirm-overlay" onClick={() => setShowDeleteConfirm(false)}>
                <div className="confirm-modal" onClick={(e) => e.stopPropagation()}>
                  <div className="confirm-icon">🗑️</div>
                  <h3 className="confirm-title">{t.confirmDelete}</h3>
                  <p className="confirm-text">{t.confirmDeleteText}</p>
                  <div className="confirm-buttons">
                    <button className="confirm-btn confirm-btn-cancel" onClick={() => setShowDeleteConfirm(false)}>
                      {t.no}
                    </button>
                    <button className="confirm-btn confirm-btn-delete" onClick={() => deleteOutfit(outfit.id)}>
                      {t.yes}
                    </button>
                  </div>
                </div>
              </div>
            )}
          </div>
        );
      }

      return (
        <div className="container">
          {/* Header */}
          <div className="header">
            <div className="header-top">
              <div>
                <p className="greeting">{getGreeting(t)}{userName ? `, ${userName}` : ''}</p>
                <h1>{t.appName}</h1>
              </div>
              <div className="header-actions">
                <button onClick={() => setShowThemeModal(true)} className="theme-btn">
                  🎨
                </button>
                <button onClick={cycleLang} className="lang-btn">
                  {lang === 'sv' ? '🇸🇪' : lang === 'en' ? '🇬🇧' : '🇪🇸'} {lang.toUpperCase()}
                </button>
                <button onClick={() => setShowSettings(true)} className="settings-btn">
                  ⚙️
                </button>
              </div>
            </div>
            {weather && (
              <div className="weather-bar">
                <span className="weather-icon">{getWeatherIcon(weather.code)}</span>
                <span className="weather-temp">{weather.temp}°</span>
                <span className="weather-tip">{getWeatherTip(weather.temp)}</span>
              </div>
            )}
          </div>

          {/* Stats */}
          {outfits.length > 0 && (
            <div className="stats-bar">
              <div className="stat-item">
                <div className="stat-number">{outfits.length}</div>
                <div className="stat-label">{t.total}</div>
              </div>
              <div className="stat-item">
                <div className="stat-number">{outfits.filter(o => o.isFavorite).length}</div>
                <div className="stat-label">{t.favorites}</div>
              </div>
              <div className="stat-item">
                <div className="stat-number">{outfits.filter(o => getDaysSinceWorn(o.lastWorn) !== null && getDaysSinceWorn(o.lastWorn) <= 7).length}</div>
                <div className="stat-label">{t.thisWeek}</div>
              </div>
            </div>
          )}

          {/* Filters */}
          {outfits.length > 0 && (
            <div className="filter-section">
              <p className="filter-label">{t.filter}</p>
              <div className="filter-pills">
                <button 
                  className={`filter-pill ${activeFilter === 'all' ? 'active' : ''}`}
                  onClick={() => setActiveFilter('all')}
                >
                  {t.all}
                </button>
                <button 
                  className={`filter-pill ${activeFilter === 'favorites' ? 'active' : ''}`}
                  onClick={() => setActiveFilter('favorites')}
                >
                  ❤️ {t.favorites}
                </button>
                {occasions.map(occ => (
                  <button
                    key={occ}
                    className={`filter-pill ${activeFilter === occ ? 'active' : ''}`}
                    onClick={() => setActiveFilter(occ)}
                  >
                    {occ}
                  </button>
                ))}
              </div>
            </div>
          )}

          {/* Random Picker */}
          {filteredOutfits.length >= 2 && (
            <div className="picker-section">
              <div className="picker-card">
                <div className="picker-content">
                  <div className="picker-header">
                    <span className="picker-label">{t.cantDecide}</span>
                    <span className="picker-icon">🎲</span>
                  </div>
                  <button 
                    className={`picker-btn ${isSpinning ? 'spinning' : ''}`}
                    onClick={pickRandom}
                    disabled={isSpinning}
                  >
                    <span className="picker-btn-icon">✨</span>
                    <span className="picker-btn-text">{isSpinning ? t.spinning : t.pickForMe}</span>
                  </button>
                </div>
              </div>
            </div>
          )}

          {/* Random Result Modal */}
          {randomResult && (
            <div className="result-overlay" onClick={closeResult}>
              <div className={`result-modal ${isSpinning ? 'result-spinning' : ''}`} onClick={e => e.stopPropagation()}>
                <div className="result-header">
                  <div className="result-badge">
                    <span>🎯</span>
                    {t.todaysPick}
                  </div>
                </div>
                <div className="result-image-wrapper">
                  {randomResult.image ? (
                    <img src={randomResult.image} alt={randomResult.name} className="result-image" />
                  ) : (
                    <div className="result-placeholder">👔</div>
                  )}
                  <div className="result-confetti">🎉</div>
                </div>
                <div className="result-info">
                  <h3 className="result-outfit-name">{randomResult.name}</h3>
                  {randomResult.occasion && (
                    <p className="result-outfit-occasion">{randomResult.occasion}</p>
                  )}
                </div>
                <div className="result-actions">
                  <button className="result-btn-primary" onClick={viewRandomResult} disabled={isSpinning}>
                    {t.wearThis}
                  </button>
                  <button className="result-btn-secondary" onClick={pickRandom} disabled={isSpinning}>
                    {isSpinning ? '...' : t.tryAgain}
                  </button>
                </div>
              </div>
            </div>
          )}

          {/* Grid */}
          {filteredOutfits.length === 0 && outfits.length === 0 ? (
            <div className="empty">
              <div className="empty-illustration">
                <div className="empty-circle empty-circle-1"></div>
                <div className="empty-circle empty-circle-2"></div>
                <div className="empty-icon">✨</div>
              </div>
              <h2 className="empty-title">{t.noOutfits}</h2>
              <p className="empty-text">{t.pressToStart}</p>
              <button onClick={() => setShowForm(true)} className="empty-cta">
                <span>+</span> {t.addFirst}
              </button>
            </div>
          ) : filteredOutfits.length === 0 ? (
            <div className="empty">
              <div className="empty-illustration">
                <div className="empty-circle empty-circle-1"></div>
                <div className="empty-circle empty-circle-2"></div>
                <div className="empty-icon">🔍</div>
              </div>
              <h2 className="empty-title">Inga {activeFilter.toLowerCase()} outfits</h2>
            </div>
          ) : (
            <div className="grid-section">
              <div className="grid-header">
                <span className="grid-title">{t.yourOutfits}</span>
                <span className="grid-count">{filteredOutfits.length} {t.outfits}</span>
              </div>
              <div className="grid">
                {filteredOutfits.map(outfit => (
                  <div key={outfit.id} onClick={() => setSelectedOutfit(outfit.id)} className="card">
                    <div className="card-image-wrapper">
                      {outfit.image ? (
                        <img src={outfit.image} alt={outfit.name} className="card-image" />
                      ) : (
                        <div className="card-placeholder">👔</div>
                      )}
                      <button 
                        className={`card-favorite ${outfit.isFavorite ? 'active' : ''}`}
                        onClick={(e) => { e.stopPropagation(); toggleFavorite(outfit.id); }}
                      >
                        {outfit.isFavorite ? '❤️' : '🤍'}
                      </button>
                      {outfit.lastWorn && (
                        <div className={`card-last-worn ${getDaysSinceWorn(outfit.lastWorn) === 0 ? 'recent' : ''}`}>
                          {getDaysSinceWorn(outfit.lastWorn) === 0 ? t.today : 
                           getDaysSinceWorn(outfit.lastWorn) === 1 ? t.yesterday :
                           `${getDaysSinceWorn(outfit.lastWorn)} ${t.daysAgo}`}
                        </div>
                      )}
                      <div className="card-overlay">
                        <span className="card-overlay-text">{countItems(outfit)} {t.items}</span>
                      </div>
                    </div>
                    <div className="card-content">
                      <h3 className="card-title">{outfit.name}</h3>
                      <div className="card-meta">
                        {outfit.occasion && <span className="card-occasion">{outfit.occasion}</span>}
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}

          {/* FAB */}
          {outfits.length > 0 && !showForm && (
            <button onClick={() => setShowForm(true)} className="fab">+</button>
          )}

          {/* Theme Modal */}
          {showThemeModal && (
            <>
              <div className="theme-modal-overlay" onClick={() => setShowThemeModal(false)} />
              <div className="theme-modal">
                <div className="theme-modal-handle" />
                <h3>{t.chooseTheme}</h3>
                <p className="theme-modal-subtitle">{t.chooseThemeSubtitle}</p>
                <div className="theme-grid">
                  {themes.map(th => (
                    <div key={th}>
                      <div
                        className={`theme-option theme-option-${th} ${theme === th ? 'active' : ''}`}
                        onClick={() => { setTheme(th); setShowThemeModal(false); }}
                      />
                      <p className="theme-label">{t.themes[th]}</p>
                    </div>
                  ))}
                </div>
              </div>
            </>
          )}

          {/* Settings Modal */}
          {showSettings && (
            <>
              <div className="settings-overlay" onClick={() => setShowSettings(false)} />
              <div className="settings-modal">
                <div className="settings-handle" />
                <h3>⚙️ {t.settings}</h3>
                
                <div className="settings-section">
                  <label className="settings-label">👤 {t.yourName}</label>
                  <input
                    type="text"
                    className="settings-input"
                    placeholder={t.yourNamePlaceholder}
                    value={userName}
                    onChange={(e) => setUserName(e.target.value)}
                  />
                </div>

                <div className="settings-section">
                  <label className="settings-label">📍 {t.yourCity}</label>
                  <input
                    type="text"
                    className="settings-input"
                    placeholder={t.yourCityPlaceholder}
                    value={userCity}
                    onChange={(e) => setUserCity(e.target.value)}
                  />
                  {weather && (
                    <p className="settings-weather-preview">
                      {getWeatherIcon(weather.code)} {weather.temp}° — {getWeatherTip(weather.temp)}
                    </p>
                  )}
                </div>

                <div className="settings-section settings-danger">
                  <label className="settings-label">🔄 {t.resetAll}</label>
                  <p className="settings-desc">{t.resetAllDesc}</p>
                  <button 
                    className="settings-reset-btn"
                    onClick={() => setShowResetConfirm(true)}
                  >
                    {t.resetAll}
                  </button>
                </div>
              </div>
            </>
          )}

          {/* Reset Confirm Modal */}
          {showResetConfirm && (
            <div className="confirm-overlay" onClick={() => setShowResetConfirm(false)}>
              <div className="confirm-modal" onClick={(e) => e.stopPropagation()}>
                <div className="confirm-icon">🔄</div>
                <h3 className="confirm-title">{t.resetConfirm}</h3>
                <p className="confirm-text">{t.resetConfirmText}</p>
                <div className="confirm-buttons">
                  <button className="confirm-btn confirm-btn-cancel" onClick={() => setShowResetConfirm(false)}>
                    {t.no}
                  </button>
                  <button className="confirm-btn confirm-btn-delete" onClick={resetAllData}>
                    {t.resetYes}
                  </button>
                </div>
              </div>
            </div>
          )}

          {/* Form Modal */}
          {showForm && (
            <>
              <div className="form-overlay" onClick={cancelEdit} />
              <div className="form">
                <div className="form-handle" />
                <h2>{editingOutfit ? t.editOutfit : t.newOutfit}</h2>
                <div className="form-fields">
                  <div className="input-group">
                    <input
                      type="text"
                      placeholder={t.outfitName}
                      value={newOutfit.name}
                      onChange={(e) => setNewOutfit({ ...newOutfit, name: e.target.value })}
                    />
                  </div>

                  <select
                    value={newOutfit.occasion}
                    onChange={(e) => setNewOutfit({ ...newOutfit, occasion: e.target.value })}
                  >
                    <option value="">{t.selectOccasion}</option>
                    {occasions.map(o => <option key={o} value={o}>{o}</option>)}
                  </select>

                  <AutoComplete 
                    placeholder={t.top} 
                    value={newOutfit.top} 
                    onChange={(val) => setNewOutfit({ ...newOutfit, top: val })}
                    userItems={userClothing}
                    lang={lang}
                    fieldType="top"
                    onRemoveUserItem={removeUserItem}
                  />
                  <AutoComplete 
                    placeholder={t.bottom} 
                    value={newOutfit.bottom} 
                    onChange={(val) => setNewOutfit({ ...newOutfit, bottom: val })}
                    userItems={userClothing}
                    lang={lang}
                    fieldType="bottom"
                    onRemoveUserItem={removeUserItem}
                  />
                  <AutoComplete 
                    placeholder={t.jacket} 
                    value={newOutfit.jacket} 
                    onChange={(val) => setNewOutfit({ ...newOutfit, jacket: val })}
                    userItems={userClothing}
                    lang={lang}
                    fieldType="jacket"
                    onRemoveUserItem={removeUserItem}
                  />
                  <AutoComplete 
                    placeholder={t.shoes} 
                    value={newOutfit.shoes} 
                    onChange={(val) => setNewOutfit({ ...newOutfit, shoes: val })}
                    userItems={userClothing}
                    lang={lang}
                    fieldType="shoes"
                    onRemoveUserItem={removeUserItem}
                  />
                  <AutoComplete 
                    placeholder={t.accessories} 
                    value={newOutfit.accessories} 
                    onChange={(val) => setNewOutfit({ ...newOutfit, accessories: val })}
                    userItems={userClothing}
                    lang={lang}
                    fieldType="accessories"
                    onRemoveUserItem={removeUserItem}
                  />

                  <label>
                    <div className="image-upload">
                      {newOutfit.image ? (
                        <img src={newOutfit.image} alt="Preview" className="image-preview" />
                      ) : (
                        <>
                          <div className="image-upload-icon">📷</div>
                          <div className="image-upload-text">{t.addImage}</div>
                        </>
                      )}
                    </div>
                    <input type="file" accept="image/*" onChange={handleImageUpload} className="hidden" />
                  </label>
                </div>

                <div className="btn-row">
                  <button onClick={cancelEdit} className="btn btn-secondary">{t.cancel}</button>
                  <button 
                    onClick={editingOutfit ? updateOutfit : addOutfit} 
                    disabled={!newOutfit.name} 
                    className="btn btn-primary"
                  >
                    {editingOutfit ? t.update : t.save}
                  </button>
                </div>
              </div>
            </>
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<OutfitApp />);
  </script>
</body>
</html>
